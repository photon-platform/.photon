#!/usr/bin/env bash

# sites
source ~/.photon/.git-tools

# alias     sites="cd ~/SITES"
alias    photon="sites photon-platform"
alias illumiphi="sites illumiphi"
alias      port="sites port-of-alsea"
alias      jill="sites jill-moser"

alias   starter="sites starter"
alias       gbp="sites gerdemann"

alias inmotion="ssh illumiphi.com"

alias sites-conf="cd /etc/apache2/sites-available"
alias hosts="sudo vim /etc/hosts"
alias restart="sudo apache2ctl restart"

alias grav-core="wget -O _grav-core.zip https://getgrav.org/download/core/grav/1.5.3 "

# photon function
#
function sites() {

  if [ $1 ]
  then
    case $1 in
      new)
        ~/.photon/sites/new.sh "$2" "$3"
        ;;
      status)
        cd ~/SITES
        find . -maxdepth 1 -mindepth 1 \
          ! -name "LOGS" \
          ! -name ".archive" \
          -type d \
          -exec sh -c '(echo {} && \
            cd {}/user && \
            git status -sb && \
            echo)' \;
        ;;
      *)
        cd ~/SITES/$1/user
        pwd
        echo
        sed -n "s/^\(\s*title:\s*\)\(.*\)/\2/p" config/site.yaml
        echo
        source .photon
        git status -sb
        echo
        ;;
    esac
  else
    cd ~/SITES
    find . -maxdepth 1 -mindepth 1 \
      ! -name "LOGS" \
      ! -name ".archive" \
      -type d \
      -exec sh -c '(echo {} && \
        cd {}/user && \
        sed -n "s/^\(\s*title:\s*\)\(.*\)/\2/p" config/site.yaml && \
        git status -sb && \
        echo)' \;

  fi
}
